/* Theme */
:root{
  --bg:#050608;
  --bg-accent:#0a111d;
  --panel:#0f1724;
  --panel-2:#141e2d;
  --panel-3:#1a2536;
  --text:#f6fbff;
  --muted:#b9c8dd;
  --accent:#38d67a;
  --accent-strong:#7ef7aa;
  --brand-gold:#f5c545;
  --brand-green:#2f9a55;
  --bad:#ff5a5a;
  --good:#39d353;
  --focus:#f5c545;
  --radius:18px;
  --font: "Nunito", "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, "Noto Sans", Arial, sans-serif;
}
body.high-contrast{
  --bg:#000;
  --bg-accent:#000;
  --panel:#000;
  --panel-2:#000;
  --panel-3:#000;
  --text:#fff;
  --muted:#f0f0f0;
  --accent:#00ff72;
  --accent-strong:#9affb8;
  --brand-gold:#ffe37a;
  --brand-green:#00c061;
  --focus:#fff;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:radial-gradient(circle at top,var(--brand-green) -20%,transparent 35%),linear-gradient(180deg,var(--bg),var(--bg-accent) 55%,#030406 100%);
  color:var(--text);
  font-family:var(--font);
  line-height:1.5;
  display:flex;
  flex-direction:column;
  min-height:100%;
}
.app-header,.app-footer{padding:16px 20px;background:transparent}
.app-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:18px;
  background:linear-gradient(135deg,rgba(20,33,46,.95),rgba(15,27,38,.9));
  border-bottom:1px solid rgba(245,197,69,.25);
  box-shadow:0 10px 25px rgba(0,0,0,.35);
}
.brand{display:flex;align-items:center;gap:16px}
.logo{width:58px;height:58px;flex-shrink:0;filter:drop-shadow(0 4px 10px rgba(0,0,0,.4))}
.brand-copy{display:flex;flex-direction:column;gap:4px}
#game-title{margin:0;font-size:1.75rem;letter-spacing:.8px;font-weight:800;text-transform:uppercase}
.tagline{margin:0;font-size:.95rem;color:var(--accent-strong);font-weight:600;letter-spacing:.6px;text-transform:uppercase}

.toggles{display:flex;align-items:flex-end;gap:12px;flex-wrap:wrap;justify-content:flex-end}
.stage-toggle{display:flex;flex-direction:column;gap:4px;min-width:150px}
.stage-toggle label{font-size:.85rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--brand-gold)}
#stage-select{
  appearance:none;
  border-radius:12px;
  border:1px solid rgba(245,197,69,.45);
  background:linear-gradient(180deg,var(--panel-3),var(--panel));
  color:var(--text);
  padding:10px 36px 10px 12px;
  font-weight:600;
  box-shadow:inset 0 0 0 1px rgba(0,0,0,.35);
  position:relative;
  min-height:44px;
}
#stage-select:focus-visible{outline:3px solid var(--focus);outline-offset:2px}

.app{max-width:980px;margin:0 auto;padding:28px 24px 40px 24px;flex:1;width:100%}
.screen{
  background:linear-gradient(180deg,var(--panel),var(--panel-2));
  border:1px solid rgba(245,197,69,.25);
  border-radius:var(--radius);
  padding:28px 28px 32px 28px;
  min-height:320px;
  box-shadow:0 24px 60px rgba(3,7,12,.55);
  outline:none;
}
.screen:focus-visible{box-shadow:0 0 0 3px var(--focus);}

.hud{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin:18px 0 6px 0;
}

.controls{display:flex;gap:12px;margin-top:14px;flex-wrap:wrap}
button{
  border-radius:14px;
  border:1px solid rgba(245,197,69,.4);
  background:linear-gradient(180deg,var(--panel-3),var(--panel));
  color:var(--text);
  padding:12px 18px;
  font-weight:700;
  cursor:pointer;
  transition:transform .18s ease,box-shadow .18s ease,border .18s ease;
  min-height:48px;
}
button:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.35);border-color:var(--brand-gold)}
button:focus-visible{outline:3px solid var(--focus);outline-offset:2px}
button.primary{background:linear-gradient(180deg,var(--brand-green),#0d321f);border-color:rgba(56,214,122,.6)}
button.secondary{background:linear-gradient(180deg,var(--panel-3),var(--panel-2));}
button[disabled]{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none}

.choice-list{display:grid;gap:12px;margin-top:16px}
.choice-list button{
  justify-content:flex-start;
  display:flex;
  gap:14px;
  align-items:center;
  font-size:1.05rem;
  text-align:left;
}
.choice-key kbd{border:1px solid rgba(245,197,69,.35);background:rgba(0,0,0,.35);padding:4px 10px;border-radius:10px;font-size:.9rem;font-weight:700}
.choice-text{flex:1;font-weight:700;letter-spacing:.2px}

.prompt{font-size:1.3rem;margin:0 0 8px 0;font-weight:800;letter-spacing:.4px}
.meta{color:var(--muted);font-size:1rem;margin:0 0 14px 0;font-weight:600}
.feedback{margin-top:12px;font-weight:800}
.feedback.good{color:var(--good)}
.feedback.bad{color:var(--bad)}
.badge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  background:linear-gradient(135deg,rgba(56,214,122,.18),rgba(245,197,69,.15));
  border:1px solid rgba(245,197,69,.4);
  border-radius:999px;
  padding:6px 16px;
  font-weight:700;
  letter-spacing:.3px;
}

#mode-badge::before{content:'üéí';}
#mode-badge[data-stage="ks4"]::before{content:'üõ°Ô∏è';}
#mode-badge[data-stage="ks3"]{background:linear-gradient(135deg,rgba(47,154,85,.35),rgba(245,197,69,.15));}
#mode-badge[data-stage="ks4"]{background:linear-gradient(135deg,rgba(245,197,69,.35),rgba(56,214,122,.15));}
#progress-badge::before{content:'üìò';}
#score-badge::before{content:'‚≠ê';}

.code{font-family:ui-monospace,Consolas,Monaco,Menlo,monospace;background:rgba(0,0,0,.3);border-radius:10px;padding:3px 8px;font-weight:700}

label{font-weight:700;display:flex;flex-direction:column;gap:6px}
.answer{
  border-radius:12px;
  border:1px solid rgba(245,197,69,.35);
  padding:10px 12px;
  background:linear-gradient(180deg,var(--panel-2),var(--panel-3));
  color:var(--text);
  font-size:1.05rem;
}
.answer:focus-visible{outline:3px solid var(--focus);outline-offset:2px}

.app-footer{color:var(--muted);font-size:.95rem;text-align:center}

.sr-only{
  position:absolute;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  white-space:nowrap;
  border:0;
}

kbd{border:1px solid rgba(245,197,69,.3);border-radius:8px;padding:3px 6px;background:rgba(0,0,0,.35);font-weight:700}

@media (max-width:840px){
  .app-header{flex-direction:column;align-items:flex-start;border-radius:0 0 24px 24px}
  .toggles{width:100%;justify-content:flex-start}
  .app{padding:24px 18px 32px 18px}
}

@media (max-width:600px){
  #game-title{font-size:1.35rem}
  .logo{width:48px;height:48px}
  .screen{padding:22px 18px}
}

body.high-contrast button{border-color:#fff;background:#000}
body.high-contrast .screen{border-color:#fff;box-shadow:none}
body.high-contrast .badge{border-color:#fff;background:#000;color:#fff}
body.high-contrast .choice-key kbd{border-color:#fff;background:#000;color:#fff}
body.high-contrast .app-header{background:#000;border-color:#fff;box-shadow:none}
